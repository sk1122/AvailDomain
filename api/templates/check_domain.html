<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Check Domains</title>
</head>
<body>
	<form action="">
		<input type="text" id="domain">
		<input type="submit" id="submit">
	</form>

	<div id="domain_data">

	</div>

	<script src="https://cdn.jsdelivr.net/npm/js-cookie@rc/dist/js.cookie.min.js"></script>
	<script>
		domain = document.getElementById('domain')
		submit = document.getElementById('submit')

		submit.addEventListener('click', function(e) {
			e.preventDefault()
			console.log(domain.value)
			document.getElementById('domain_data').innerHTML = "Loading..."
			fetch("{% url 'check_availablity' %}", {
				method: 'POST',
				body: JSON.stringify({
					domain: domain.value
				}),
				headers: {
					'Content-Type': 'application/json',
					"X-CSRFToken": Cookies.get('csrftoken')
				}
			})
			.then(res => {
				const d = res.json()
				.then(data => {
					if(data.data == null) {
						document.getElementById('domain_data').innerHTML = domain.value + " is Available!!!"
						return
					}
					document.getElementById('domain_data').innerHTML = `
						<h1>${data.data['name']}</h1>
						<p>${data.data['registrant_country']} | ${data.data['registrant']}</p>
						<p>Creation Date - ${data.data['creation_date']}</p>
						<p>Expiration Date - ${data.data['expiration_date']}</p>
						<p>Registrar - ${data.data['registrar']}</p>

						<p>Name Servers - ${data.data['name_servers']}</p>
					`
				})
			})
		})
	</script>
</body>
</html>